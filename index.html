<!DOCTYPE html>
<html>
  <head>
    <title>Google Calendar Appointment</title>
    <script>
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }
    
      function initClient() {
        gapi.client.init({
          apiKey: 'API_KEY',
          clientId: 'CLIENT_ID',
          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],
          scope: 'https://www.googleapis.com/auth/calendar'
        }).then(function () {
          // Handle successful initialization
        }, function (error) {
          console.error(error);
          if (error.details === "You have created a new client application that uses libraries for user authentication or authorization that will soon be deprecated. New clients must use the new libraries instead; existing clients must also migrate before these libraries are deprecated. See the [Migration Guide](https://developers.google.com/identity/gsi/web/guides/gis-migration) for more information.") {
            console.error("Your Google API client library is outdated and needs to be updated. Please follow the migration guide: https://developers.google.com/identity/gsi/web/guides/gis-migration");
          }
        });
      }
    </script>
    <script src="https://apis.google.com/js/api.js" onload="handleClientLoad()"></script>

    <meta name="google-signin-client_id" content="875163929025-30af1oejvkrjicskbdikm8kkep56s153.apps.googleusercontent.com">
    <div class="g-signin2" data-onsuccess="onSignIn"></div>
    <script>
            function onSignIn(googleUser) {
        // Get the user's ID token and basic profile information
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("ID Token: " + id_token);
      }
      function MakeCalenderEvent(event) {
        event.preventDefault();
        gapi.load("client:auth2", function() {
          gapi.auth2.init({
            client_id: "875163929025-30af1oejvkrjicskbdikm8kkep56s153.apps.googleusercontent.com",
            scope: "https://www.googleapis.com/auth/calendar"
          }).then(function() {
            if (gapi.auth2.getAuthInstance().isSignedIn.get()) {
              gapi.client.load("calendar", "v3").then(function() {
                var event = {
                  summary: document.getElementById("eventName").value,
                  start: {
                    dateTime: document.getElementById("startDate").value,
                    timeZone: "Netherlands/Amsterdam"
                  },
                  end: {
                    dateTime: document.getElementById("endDate").value,
                    timeZone: "Netherlands/Amsterdam"
                  }
                };
                var request = gapi.client.calendar.events.insert({
                  calendarId: "he2cnbmqjtku6paaqokqa765u4@group.calendar.google.com",
                  resource: event
                });
                request.execute(function(event) {
                  console.log("Event created: " + event.htmlLink);
                });
              }).catch(function(error) {
                console.error(error);
              });
            } else {
              gapi.auth2.getAuthInstance().signIn();
            }
          });
        });
      }
    </script>
    
  </head>
  <body>
    
    <h1>Create Google Calendar Appointment</h1>
    <label for="eventName">Event Name:</label><br>
    <input type="text" id="eventName" name="eventName" required><br><br></input>
    <label for="startDate">Start Date and Time:</label><br>
    <input type="datetime-local" id="startDate" name="startDate" required><br><br></input>
    <label for="endDate">End Date and Time:</label><br>
    <input type="datetime-local" id="endDate" name="endDate" required><br><br></input>
    <button onclick="MakeCalenderEvent(event)">Create Event</button>
 

  </body>
</html>
