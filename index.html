<html>
  <head>
    <script type="text/javascript">
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }
  
      function initClient() {
        gapi.client.init({
          apiKey: 'APIAIzaSyBGbQjVOJ-2gj5-OopuiOpyYqN80BCT4qc_KEY',
          clientId: '875163929025-30af1oejvkrjicskbdikm8kkep56s153.apps.googleusercontent.com',
          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest'],
          scope: 'https://www.googleapis.com/auth/calendar'
        }).then(function () {
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
          document.getElementById('authorize-button').onclick = handleAuthClick;
        });
      }
  
      function handleAuthClick() {
        gapi.auth2.getAuthInstance().signIn();
      }
  
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
          makeApiCall();
        }
      }
  
      function makeApiCall() {
        gapi.client.calendar.events.insert({
          calendarId: 'primary',
          resource: {
            summary: 'Test Event',
            location: 'Test Location',
            description: 'This is a test event created using the Google Calendar API',
            start: {
              dateTime: new Date().toISOString(),
              timeZone: 'America/Los_Angeles'
            },
            end: {
              dateTime: new Date().toISOString(),
              timeZone: 'America/Los_Angeles'
            }
          }
        }).then(function(response) {
          console.log(response);
        });
      }
    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="handleClientLoad()"></script>
  </head>
  <body>
    <button id="authorize-button">Authorize</button>
  </body>
</html>
