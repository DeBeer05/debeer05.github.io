<!DOCTYPE html>
<html>
  <head>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
      (function() {
        // Your Client ID can be retrieved from your project in the Google
        // Developer Console, https://console.developers.google.com
        var CLIENT_ID = '875163929025-30af1oejvkrjicskbdikm8kkep56s153.apps.googleusercontent.com';

        var apiKey = 'AIzaSyBGbQjVOJ-2gj5-OopuiOpyYqN80BCT4qc';

        var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];

        var SCOPES = "https://www.googleapis.com/auth/calendar";

        function handleClientLoad() {
          gapi.load('client:auth2', initClient);
        }

        function initClient() {
          gapi.client.init({
            apiKey: apiKey,
            discoveryDocs: DISCOVERY_DOCS,
            clientId: CLIENT_ID,
            scope: SCOPES
          }).then(function () {
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
          });
        }

        function updateSigninStatus(isSignedIn) {
          if (isSignedIn) {
            createEvent();
          }
        }

        function handleSignInClick(event) {
          gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignOutClick(event) {
          gapi.auth2.getAuthInstance().signOut();
        }

        function createEvent() {
          var event = {
            'summary': document.getElementById("eventTitle").value,
            'start': {
              'dateTime': document.getElementById("eventTime").value,
              'timeZone': 'America/Los_Angeles'
            },
            'end': {
              'dateTime': document.getElementById("eventTime").value,
              'timeZone': 'America/Los_Angeles'
            }
          };

          var request = gapi.client.calendar.events.insert({
            'calendarId': 'primary',
            'resource': event
          });

          request.execute(function(event) {
            document.getElementById("eventStatus").innerHTML = "Event created: " + event.htmlLink;
          });
        }
      })();
    </script>
  </head>
  <body>
    <div>
      <input type="text" id="eventTitle" placeholder="Event Title">
      <input type="datetime-local" id="eventTime" placeholder="Event Time">
      <button id="signin-button" onclick="handleSignInClick()">Sign In</button>
      <button id="signout-button" onclick="handleSignOutClick()">Sign Out</button>
    </div>
    <div id="eventStatus"></div>
  </body>
</html>
